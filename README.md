# 💻 GnuCOBOL（OpenCOBOL）バッチ処理サンプル集

## 📝 プロジェクト概要

このプロジェクトは、**GnuCOBOL (GNU OpenCOBOL)** を用いて開発される、**一般的なビジネスバッチ処理**のパターンを網羅したサンプルコード集です。

COBOL学習者が実務で遭遇する頻度の高い、「ファイルの突き合わせ（マッチング）」「データ集計」「データ抽出」などの基本的なバッチ処理のロジックを、すぐに実行可能な形で提供します。

## 🎯 目的

* GnuCOBOLによる**実用的なバッチ処理ロジック**の理解を深める。
* COBOLの**ファイル処理（順ファイル、索引ファイル）** や **SORT文** の具体的な使用方法を学ぶ。
* 実務開発における**リファレンス**として活用する。

## 🚀 収録されているサンプル（抜粋）

主要なバッチ処理のカテゴリ別にサンプルを分類しています。

| カテゴリ | サンプル名 | 概要 |
| :--- | :--- | :--- |
| **マッチング** | `MATCH01.cbl` | マスタファイルとトランザクションファイルの**キー照合（追加/更新/削除）**。 |
| **集計** | `SUMM01.cbl` | 入力ファイルから**キーブレイク**による売上集計を行い、合計値を算出。 |
| **抽出/選択**| `SELECT01.cbl` | 条件に合致するレコードのみを抽出し、**エラーリスト**を作成。 |
| **変換** | `REFORMAT01.cbl` | 固定長ファイルを読み込み、項目を並べ替えて別の固定長ファイルに出力。 |
| **ソート** | `SORT01.cbl` | COBOLの**SORT文**を使用してファイルをソートする基本処理。 |

---

## 🛠️ 環境構築と実行方法

### 1. 必要な環境

* **GnuCOBOLコンパイラ**: バージョン 3.0 以降を推奨します。
    * インストール方法: `sudo apt install gnucobol` (Linuxの場合)

### 2. サンプルの実行

1.  **コンパイル**
    ```bash
    # 例：SUMM01.cblをコンパイルする場合
    cobc -x SUMM01.cbl
    ```
2.  **実行**
    サンプル実行に必要な**入力データファイル**（例：`INPUT_SUMM.DAT`）を準備した後、以下のコマンドで実行します。
    ```bash
    ./SUMM01
    ```
    * 各サンプルディレクトリ内に、実行に必要な**データ定義**と**サンプルデータ**を配置しています。

### 3. データ定義について

全てのサンプルプログラムは、プログラム内で定義された以下の構造を基本とします。

* **ファイル定義**: `SELECT ... ASSIGN TO ...`
* **レコード定義**: `FD`句および`01`レベルの項目定義

---

## 📁 ファイル配置

本プロジェクトは、ソースコードとデータを明確に分離するために、以下のディレクトリ構成を採用しています。

*   **`src/`**: COBOLソースコード（`.cbl`）およびコンパイル後の実行可能ファイルを格納します。
    *   機能ごとにサブディレクトリ（例: `matching`, `aggregation`）を作成し、関連ファイルをまとめて管理します。
*   **`data/`**: プログラムが使用する入力データファイル、およびプログラムが出力するファイルを格納します。

---

## 📊 データファイルレイアウト

`data/` ディレクトリのサブディレクトリに配置されている各ファイルの役割は以下の通りです。

| ファイル名 | I/O | 関連プログラム | 概要 |
| :--- | :--- | :--- | :--- |
| `matching/MASTER.DAT` | 入力 | `MATCH01.cbl` | マッチング処理のマスターファイル |
| `matching/TRAN.DAT` | 入力 | `MATCH01.cbl` | マッチング処理のトランザクションファイル |
| `matching/NEWMAST.DAT` | 出力 | `MATCH01.cbl` | マッチング処理後の新マスターファイル |
| `matching/ERROR.LST` | 出力 | `MATCH01.cbl` | マッチング処理のエラーリスト |
| `aggregation/INPUT_SUMM.DAT` | 入力 | `SUMM01.cbl` | 集計処理の入力データ |
| `aggregation/OUTPUT_SUMM.DAT`| 出力 | `SUMM01.cbl` | 集計処理の出力結果 |
| `aggregation/CONTROL_LIST.DAT`| 出力 | `SUMM01.cbl` | 集計処理のコントロールリスト（件数・合計） |
| `selection/INPUT_SELECT.DAT`| 入力 | `SELECT01.cbl` | 抽出処理の入力データ |
| `selection/OUTPUT_SELECT.DAT`| 出力 | `SELECT01.cbl` | 抽出処理の出力結果 |
| `selection/ERROR_SELECT.LST` | 出力 | `SELECT01.cbl` | 抽出処理のエラーリスト |
| `reformatting/INPUT-REFORMAT.DAT`| 入力 | `REFORMAT01.cbl` | 変換処理の入力データ |
| `reformatting/OUTPUT-REFORMAT.DAT`| 出力 | `REFORMAT01.cbl` | 変換処理の出力結果 |
| `sorting/INPUT-SORT.DAT`| 入力 | `SORT01.cbl` | ソート処理の入力データ |
| `sorting/OUTPUT-SORT.DAT`| 出力 | `SORT01.cbl` | ソート処理の出力結果 |
